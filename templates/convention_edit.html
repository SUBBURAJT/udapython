{% extends 'partials/base.html' %}
{% load static %}

{% block extra_css %}


<link href="{% static 'libs/select2/css/select2.min.css' %}" rel="stylesheet" type="text/css">

<link href="{% static 'libs/bootstrap-datepicker/css/bootstrap-datepicker.min.css' %}" rel="stylesheet">

<!-- Sweet Alert-->
<link href="{% static 'libs/sweetalert2/sweetalert2.min.css' %}" rel="stylesheet" type="text/css" />
<style>
    .boxRowAdd {
        margin: 5px 0px !important;
    }
    .err {
        border-color: #ff3d60 !important;
        background-image: none !important;
    }
</style>
{% endblock extra_css %}
{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body">

                <form class='needs-validation' method="post" id="convention_reg_frm" autocomplete="off" novalidate>
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-12">
                            <h4 class='fw-600 mb-2 headerFall'>YOUR PERSONAL INFO</h4>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Practice Name</label>
                                <input type="text" class="form-control" name="practice_name" id="practice_name" value="{{ handon_details.practice_name }}" placeholder='Enter practice name'>
                                <div class="invalid-feedback">Practice name is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">First Name <span
                                        class='text-danger'>*</span></label>
                                <input type="text" class="form-control" placeholder='Enter first name' id="first_name" name="first_name" value="{{ handon_details.name }}" required>
                                <div class="invalid-feedback">First name is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Last Name <span class='text-danger'>*</span></label>
                                <input type="text" class="form-control" id="last_name" name="last_name" value="{{ handon_details.last_name }}" placeholder='Enter last name' required>
                                <div class="invalid-feedback">Last name is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Phone <span class='text-danger'>*</span></label>
                                <input type="text" class="form-control" id="phone" name="phone" value="{{ handon_details.phone }}" placeholder='Enter phone number' required>
                                <div class="invalid-feedback">Phone number is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Email <span class='text-danger'>*</span></label>
                                <input type="email" class="form-control email_in" id="email" name="email" value="{{ handon_details.email }}" placeholder='Enter email address' required>
                                <div class="invalid-feedback">Email is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Address <span class='text-danger'>*</span></label>
                                <input type="text" class="form-control" name="address" id="address" value="{{ handon_details.address }}" placeholder='Enter address' required>
                                <div class="invalid-feedback">Address is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">City <span class='text-danger'>*</span></label>
                                <input type="text" class="form-control" name="city" id="city" value="{{ handon_details.city }}" placeholder='Enter city' required>
                                <div class="invalid-feedback">City is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">State <span class='text-danger'>*</span></label>
                                <input type="text" class="form-control" name="state" id="state" value="{{ handon_details.state }}" placeholder='Enter state' required>
                                <div class="invalid-feedback">State is required</div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Zip <span class='text-danger'>*</span></label>
                                <input type="text" name="zipcode" id="zipcode" class="form-control" value="{{ handon_details.zipcode }}" placeholder='Enter zipcode' required>
                                <div class="invalid-feedback">Zip is required</div>
                            </div>
                        </div>

                        <div class="col-12 mt-3">
                            <div class='bg-primary-transparent p-4 ps-0 br-5'>
                                <h6 class='fw-600 text-uppercase mb-3'>Notes</h6>
                                <ul class='list-group ps-4'>
                                    <li class="py-1">Sorry no refunds will be made.
                                    </li>
                                    <li class="py-1">Staff does not need to register
                                        with a dentist. Guests need to be registered with a dentist.</li>
                                    <li class="py-1">The deadline for all
                                        pre-registration is March 13, 2020, after this date all registration must be
                                        done onsite at the Salt Palace Convention Center.</li>
                                </ul>
                            </div>
                        </div>
                        {% for cv in convention %}
                            {% with j=forloop.counter cv_id=cv.id %}
                                {% if j == 1 %}
                                <div class="col-12 mt-3">
                                    <div>
                                        <div class="alert alert-info fade show text-center mt-4 fs-13 py-1 mb-0" role="alert">
                                            <span class="alert-inner--text">If you would like to add more than one person to any
                                                category please enter the number first to populate the same fields</span>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                        <div class="col-12 mt-4 cv_container">
                            <input type="hidden" name="hdn_cv_id" id="hdn_cv_id" value="{{cv.id}}">
                            <input type="hidden" name="hdn_cv_price" id="hdn_cv_price" value="{{cv.price}}">
                            <div class="row mt-0 align-items-center">
                                <div class="col-lg-7">
                                    <h5 class='fw-600 mb-lg-0 mb-3 headerFall'>{{cv.name}} (${{ cv.price }})</h5>
                                </div>
                                <div class="col-lg-5 text-right">
                                    <div class='d-flex justify-content-lg-end'>
                                        {% if cv.id in handon_details.convention_ws.cv_ws_ids %}
                                            {% for key,val in handon_details.convention_ws.cv_ws_cnt.items %}
                                                {% if key == cv_id %}
                                                <div class="input-group min-130 flex-nowrap me-3">
                                                    <input class="form-control-wof br-tr-4 br-br-4 cnt_input" placeholder='Count'
                                                        type="text" value="{{val}}" disabled>
                                                    <span class="input-group-btn roundAbs" data-bs-toggle='tooltip'
                                                        title='Increase Count'>
                                                        <button type="button" class="quantity-right-plus btn btn-number add_new_cv">
                                                            <i class="mdi mdi-plus fs-17"></i>
                                                        </button>
                                                    </span>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                            {% for key,val in handon_details.convention_ws.cv_ws_price.items %}
                                                {% if key == cv_id %}
                                                <div class="input-group min-130 flex-nowrap">
                                                    <div class="input-group-text">
                                                        <i class="fas fa-dollar-sign tx-16 lh-0 op-6"></i>
                                                    </div>
                                                    <input class="form-control-wof sec_gnd_total" type="text" value="{{val}}" disabled>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                        {% else %}
                                        <div class="input-group min-130 flex-nowrap me-3">
                                            <input class="form-control-wof br-tr-4 br-br-4 cnt_input" placeholder='Count'
                                                type="text" value="" disabled>
                                            <span class="input-group-btn roundAbs" data-bs-toggle='tooltip'
                                                title='Increase Count'>
                                                <button type="button" class="quantity-right-plus btn btn-number add_new_cv">
                                                    <i class="mdi mdi-plus fs-17"></i>
                                                </button>
                                            </span>
                                        </div>
                                        <div class="input-group min-130 flex-nowrap">
                                            <div class="input-group-text">
                                                <i class="fas fa-dollar-sign tx-16 lh-0 op-6"></i>
                                            </div>
                                            <input class="form-control-wof sec_gnd_total"   type="text" value="" disabled>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% if cv.id == 1 or cv.id == 2 or cv.id == 5 %}
                                {% if cv.id in handon_details.convention_ws.cv_ws_ids %}
                                    {% for  key, value in handon_details.convention_ws.items %}
                                        {% if key == cv.id %}
                                            {% for val in value %}
                                            <div class="row boxRow" id="text-box-{{cv.id}}">
                                                <input type="hidden" data-key="hdn_cv_ws_id" id="hdn_cv_ws_id" name="hdn_cv_ws_id" value="{{val.id}}">
                                                <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                                <div class="col-md-5 mb-lg-0 mb-3">
                                                    <input type="text" class='form-control form-control-wof input_required ada_num' data-key="ada" placeholder='ADA#' value="{{val.ada}}">
                                                    <div class="invalid-feedback">ADA is required</div>
                                                </div>
                                                <div class="col-md-5 mb-md-0 mb-3">
                                                    <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name' value="{{val.name}}">
                                                    <div class="invalid-feedback">Full name is required</div>
                                                </div>
                                                <div class="col-md-2">
                                                    <input type="text" class='form-control-wof sec_price' placeholder='Price' data-key="ind_price" value="{{val.price}}" readonly>
                                                </div>
                                            </div>
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                                {% else %}                                
                                    <div class="row boxRow" id="text-box-{{cv.id}}">
                                        <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                        <div class="col-md-5 mb-lg-0 mb-3">
                                            <input type="text" class='form-control form-control-wof input_required ada_num' data-key="ada" placeholder='ADA#' value="">
                                            <div class="invalid-feedback">ADA is required</div>
                                        </div>
                                        <div class="col-md-5 mb-md-0 mb-3">
                                            <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name' value="">
                                            <div class="invalid-feedback">Full name is required</div>
                                        </div>
                                        <div class="col-md-2">
                                            <input type="text" class='form-control-wof sec_price' id="sec_tot" placeholder='Price' value="" readonly>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% if cv.id == 3 or cv.id == 4 or cv.id == 6 or cv.id == 7 or cv.id == 16 %}
                            {% if cv.id in handon_details.convention_ws.cv_ws_ids %}
                                {% for  key, value in handon_details.convention_ws.items %}
                                    {% if key == cv.id %}
                                        {% for val in value %}
                                        <div class="row boxRow" id="text-box-{{cv.id}}">
                                            <input type="hidden" data-key="hdn_cv_ws_id" id="hdn_cv_ws_id" name="hdn_cv_ws_id" value="{{val.id}}">
                                            <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                            <div class="col-md-10 mb-md-0 mb-3">
                                                <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name' value="{{val.name}}">
                                                <div class="invalid-feedback">Full name is required</div>
                                            </div>
                                            <div class="col-md-2">
                                                <input type="text" class='form-control-wof sec_price' placeholder='Price' data-key="ind_price" id="sec_tot" value="{{val.price}}" readonly>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                            <div class="row boxRow" id="text-box-{{cv.id}}">
                                <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                <div class="col-md-10 mb-md-0 mb-3">
                                    <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name'>
                                    <div class="invalid-feedback">Full name is required</div>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class='form-control-wof sec_price' placeholder='Price' id="sec_tot" readonly>
                                </div>
                            </div>
                            {% endif %}
                        {% endif %}
                        {% if cv.id == 8 %}
                            {% if cv.id in handon_details.convention_ws.cv_ws_ids %}
                                {% for  key, value in handon_details.convention_ws.items %}
                                    {% if key == cv.id %}
                                        {% for val in value %}
                                        <div class="row boxRow" id="text-box-{{cv.id}}">
                                            <input type="hidden" data-key="hdn_cv_ws_id" id="hdn_cv_ws_id" name="hdn_cv_ws_id" value="{{val.id}}">
                                            <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                            <div class="col-md-5 mb-md-0 mb-3">
                                                <select class='form-control form-control-wof select2 input_required ' data-placeholder='Code' data-key="ada">
                                                <option></option>
                                                <option value="A - Assistant" {% if val.ada == 'A - Assistant' %} selected {% endif %}>A - Assistant</option>
                                                <option value="L - Lab Technician" {% if val.ada == 'L - Lab Technician' %} selected {% endif %}>L - Lab Technician</option>
                                                <option value="O - Office Staff" {% if val.ada == 'O - Office Staff' %} selected {% endif %}>O - Office Staff</option>
                                                <!-- <option value="O - Office Staff" {{ val.ada|yesno:'"selected",""' }}>O - Office Staff</option> -->
                                                </select>
                                                <div class="invalid-feedback">Code is required</div>
                                            </div>
                                            <div class="col-md-5 mb-md-0 mb-3">
                                                <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name' value="{{val.name}}">
                                                <div class="invalid-feedback">Full name is required</div>
                                            </div>
                                                
                                            <div class="col-md-2">
                                                <input type="text" class='form-control-wof sec_price' placeholder='Price' data-key="ind_price" value="{{val.price}}" id="sec_tot" readonly>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                            {% else %}   
                            <div class="row boxRow" id="text-box-{{cv.id}}">
                                <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                <div class="col-md-5 mb-md-0 mb-3">
                                    <select class='form-control form-control-wof select2 input_required ' data-placeholder='Code' data-key="ada">
                                    <option></option>
                                    <option value="A - Assistant" >A - Assistant</option>
                                    <option value="L - Lab Technician" >L - Lab Technician</option>
                                    <option value="O - Office Staff" >O - Office Staff</option>
                                    </select>
                                    <div class="invalid-feedback">Code is required</div>
                                </div>
                                <div class="col-md-5 mb-md-0 mb-3">
                                    <input type="text" class='form-control form-control-wof input_required ada_name' data-key="name" placeholder='Full name'>
                                    <div class="invalid-feedback">Full name is required</div>
                                </div>
                                    
                                <div class="col-md-2">
                                    <input type="text" class='form-control-wof sec_price' id="sec_tot" placeholder='Price' readonly>
                                </div>
                            </div>
                            {% endif %}
                        {% endif %}
                        {% if cv.id == 15 %}
                            {% if cv.id in handon_details.convention_ws.cv_ws_ids %}
                                {% for  key, value in handon_details.convention_ws.items %}
                                    {% if key == cv.id %}
                                        {% for val in value %}
                                            <div class="row boxRow" id="text-box-{{cv.id}}">
                                                <input type="hidden" data-key="hdn_cv_ws_id" id="hdn_cv_ws_id" name="hdn_cv_ws_id" value="{{val.id}}">
                                                <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                                <div class="col-md-5 mb-md-0 mb-3">
                                                    <input type="text" class='form-control form-control-wof input_required ada_name' placeholder='Full name' data-key="name" value="{{val.name}}">
                                                    <div class="invalid-feedback">Full name is required</div>
                                                </div>
                                                <div class="col-md-5 mb-md-0 mb-3">
                                                    <input type="text" class='form-control form-control-wof input_required id_num' placeholder='ID#' data-key="ada" value="{{val.ada}}">
                                                    <div class="invalid-feedback">ID is required</div>
                                                </div>
                                                <div class="col-md-2">
                                                    <input type="text" class='form-control-wof sec_price' data-key="ind_price" placeholder='Price' value="{{val.price}}" id="sec_tot" readonly>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                {% endfor %}
                            {% else %}  
                                <div class="row boxRow" id="text-box-{{cv.id}}">                                
                                    <span class='boxClose removebutton' data-id="{{ cv.id }}"><i class='mdi mdi-close'></i></span>
                                    <div class="col-md-5 mb-md-0 mb-3">
                                        <input type="text" class='form-control form-control-wof input_required ada_name' placeholder='Full name' data-key="name">
                                        <div class="invalid-feedback">Full name is required</div>
                                    </div>
                                    <div class="col-md-5 mb-md-0 mb-3">
                                        <input type="text" class='form-control form-control-wof input_required id_num' placeholder='ID#' data-key="ada">
                                        <div class="invalid-feedback">ID is required</div>
                                    </div>
                                    <div class="col-md-2">
                                        <input type="text" class='form-control-wof sec_price' placeholder='Price' id="sec_tot" readonly>
                                    </div>
                                </div>
                            {% endif %}
                            <div class='pt-2'>
                                <div class="alert alert-info fade show text-center fs-13 py-1" role="alert">
                                    <span class="alert-inner--text">2020 Pricing Only Celebrating our New Dental
                                        Hygienist Affiliate Membership If you would like to join, please follow the
                                        following link:
                                        <a target="_new"
                                            href="https://ebusiness.ada.org/productcatalogPo3/62848/UT0006FB5F4SW43/UTeCatalog/UDA-2019-Hygienist-Membership/">https://ebusiness.ada.org/productcatalogPo3/62848/UT0006FB5F4SW43/UTeCatalog/UDA-2019-Hygienist-Membership/</a>
                                    </span>
                                </div>
                            </div>
                            {% endif %}
                            {% if cv.id == 1 %}
                            <div class='pt-2'>
                                <div class="alert alert-info fade show text-center fs-13 py-1" role="alert">
                                    <span class="alert-inner--text">If you would like to join on UDA Membership, please
                                        follow the following link:
                                        <a target="_new"
                                            href="https://www.uda.org/member-center/join-renew/join-renew-now/">https://www.uda.org/member-center/join-renew/join-renew-now/</a>
                                    </span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        {% endwith %}
                        {% endfor %}
                        
                        <div class="col-12 mb-3">
                            <div class="accordion conAccor conAccorEdit" id="accordionExample">
                                {% if workshops_cnt > 0 %}
                                    {% for wh in workshops %}
                                        {% with j=forloop.counter %}
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="heading{{j}}">
                                                <button class="accordion-button collapsed" type="button"
                                                    data-bs-toggle="collapse" data-bs-target="#collapse{{j}}" aria-expanded="true"
                                                    aria-controls="collapse{{j}}">
                                                    {{ wh.workshop }}
                                                </button>
                                            </h2>
                                            <div id="collapse{{j}}" class="accordion-collapse collapse"
                                                aria-labelledby="heading{{j}}" data-bs-parent="#accordionExample">
                                                <div class="accordion-body pt-2">
                                                    <div class="row tRow d-lg-flex d-none">
                                                        <div class="col-xl-8 col-lg-7 ps-0">
                                                            <h5>Hands on workshops</h5>
                                                        </div>
                                                        <div class="col-xl-4 col-lg-5 pe-0">
                                                            <div class='d-flex justify-content-end'>
                                                                <h5 class='min-130 me-3'>Count</h5>
                                                                <h5 class='min-130'>Cost</h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        {% for wh_slot in wh.workshop_slot %}
                                                        {% with ws_id=wh_slot.id %}
                                                        <div class="col-12 mt-3 wh_container">
                                                            <input type="hidden" name="hdn_wh_id" id="hdn_wh_id" value="{{wh_slot.id}}">
                                                            <input type="hidden" name="hdn_wh_price" id="hdn_wh_price" value="{{wh_slot.amount}}">
                                                            <div class="row mt-0 align-items-center">
                                                                <div class="col-xl-8 col-lg-7">
                                                                    <h5 class='fw-600 mb-lg-0 mb-3 headerFall'>{{wh_slot.name}} (${{wh_slot.amount}})</h5>
                                                                </div>
                                                                <div class="col-xl-4 col-lg-5 text-right">
                                                                    <div class='d-flex justify-content-lg-end'>
                                                                        {% if wh_slot.id in handon_details.handon_ws.ws_ids %}
                                                                        {% for key,val in handon_details.handon_ws.cv_ws_cnt.items %}
                                                                            {% if key == ws_id %}
                                                                            <div class="input-group min-130 flex-nowrap me-3">
                                                                                <input class="form-control-wof br-tr-4 br-br-4 wh_cnt_input"
                                                                                    placeholder='Count' type="text" value="{{val}}" disabled>
                                                                                <span class="input-group-btn roundAbs"
                                                                                    data-bs-toggle='tooltip' title='Increase Count'>
                                                                                    <button type="button"
                                                                                        class="quantity-right-plus btn btn-number add_new_ws">
                                                                                        <i class="mdi mdi-plus fs-17"></i>
                                                                                    </button>
                                                                                </span>
                                                                            </div>
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                        {% for key,val in handon_details.handon_ws.cv_ws_price.items %}
                                                                            {% if key == ws_id %}
                                                                            <div class="input-group min-130 flex-nowrap">
                                                                                <div class="input-group-text">
                                                                                    <i class="fas fa-dollar-sign tx-16 lh-0 op-6"></i>
                                                                                </div>
                                                                                <input class="form-control-wof sec_gnd_total_wh" type="text" value="{{val}}" disabled>
                                                                            </div>
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                        {% else %}
                                                                        <div class="input-group min-130 flex-nowrap me-3">
                                                                            <input class="form-control-wof br-tr-4 br-br-4"
                                                                                placeholder='Count' type="text" value="" disabled>
                                                                            <span class="input-group-btn roundAbs"
                                                                                data-bs-toggle='tooltip' title='Increase Count'>
                                                                                <button type="button"
                                                                                    class="quantity-right-plus btn btn-number add_new_ws">
                                                                                    <i class="mdi mdi-plus fs-17"></i>
                                                                                </button>
                                                                            </span>
                                                                        </div>
                                                                        <div class="input-group min-130 flex-nowrap">
                                                                            <div class="input-group-text">
                                                                                <i class="fas fa-dollar-sign tx-16 lh-0 op-6"></i>
                                                                            </div>
                                                                            <input class="form-control-wof sec_gnd_total_wh" type="text" value="" disabled>
                                                                        </div>
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            {% if wh_slot.id in handon_details.handon_ws.ws_ids %}
                                                                {% for  key, value in handon_details.handon_ws.items %}
                                                                    {% if key == wh_slot.id %}
                                                                        {% for val in value %}
                                                                        <div class="row boxRow" id="text-box-wh-{{wh_slot.id}}">
                                                                            <input type="hidden" data-key="hdn_ws_id" id="hdn_ws_id" name="hdn_ws_id" value="{{val.id}}">
                                                                            <span class='boxClose wh_removebutton' data-id="{{wh_slot.id}}"><i class='mdi mdi-close'></i></span>
                                                                            <div class="col-md-10 mb-md-0 mb-3">
                                                                                <input type="text" class='form-control form-control-wof wh_input_required wh_name' data-key="wh_name" placeholder='Full name' value="{{val.name}}">
                                                                                <div class="invalid-feedback">Full name is required</div>
                                                                            </div>
                                                                            <div class="col-md-2">
                                                                                <input type="text" class='form-control-wof sec_price_wh'
                                                                                    placeholder='Price' id="sec_tot_wh" value="{{val.amount}}" readonly>
                                                                            </div>
                                                                        </div>
                                                                        {% endfor %}
                                                                    {% endif %}
                                                                {% endfor %}
                                                            {% else %} 
                                                            <div class="row boxRow" id="text-box-wh-{{wh_slot.id}}">
                                                                <span class='boxClose wh_removebutton' data-id="{{wh_slot.id}}"><i class='mdi mdi-close'></i></span>
                                                                <div class="col-md-10 mb-md-0 mb-3">
                                                                    <input type="text" class='form-control form-control-wof wh_input_required wh_name' data-key="wh_name" placeholder='Full name'>
                                                                    <div class="invalid-feedback">Full name is required</div>
                                                                </div>
                                                                <div class="col-md-2">
                                                                    <input type="text" class='form-control-wof sec_price_wh'
                                                                        placeholder='Price' id="sec_tot_wh" readonly>
                                                                </div>
                                                            </div>
                                                            {% endif %}
                                                        </div>
                                                        {% endwith %}
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% endwith %}
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>


                        <div class="col-12 mt-3">
                            <div class='d-flex align-items-center justify-content-end'>
                                <p class='fw-600 mb-0 me-3 text-uppercase'>Grand Total ($)</p>
                                <input type="text" class='form-control-wof min-130' name="grnd_tot" id="grnd_tot" value='{{ handon_details.amount }}' readonly>
                            </div>
                            <div class='d-flex align-items-center justify-content-end mt-4'>
                                <p class='fw-600 mb-0 me-3 text-uppercase'>New Total ($)</p>
                                <input type="text" class='form-control-wof min-130' name="new_tot" id="new_tot" value='{{ handon_details.amount }}' readonly>
                            </div>
                            <div class='d-flex align-items-center justify-content-end mt-4'>
                                <p class='fw-600 mb-0 me-3 text-uppercase'>User to pay ($)</p>
                                <input type="text" class='form-control-wof min-130' name="user_to_pay" id="user_to_pay" value=''>
                            </div>
                        </div>

                        <div class="col-12">
                            <h4 class='fw-600 mb-3 mt-4 headerFall'>FOR OFFICE USE ONLY</h4>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Transaction Date <span
                                        class='text-danger'>*</span></label>
                                <div class="input-group" id="datepicker1">
                                    <input type="text" class="form-control" placeholder="MM/DD/YYYY"
                                        data-date-format="mm/dd/yyyy" data-date-container='#datepicker1'
                                        data-provide="datepicker" id="transaction_date" name="transaction_date" value='{{ handon_details.created_on|date:"m/d/Y"}}' required>

                                    <span class="input-group-text"><i class="mdi mdi-calendar"></i></span>
                                </div>
                                <div class="invalid-feedback">Transaction date is required</div>
                            </div>
                        </div>
                        {% if handon_details.off_transaction_status == 1 %}
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Transaction ID</label>
                                <input type="text" class="form-control" id="transaction_id" name="transaction_id"  value='{{ handon_details.transaction_ref }}' placeholder='Enter transaction ID'>
                                <div class="invalid-feedback">Transaction ID is required</div>
                            </div>
                        </div>
                        {% else %}
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Transaction ID</label>
                                <input type="text" class="form-control" id="transaction_id" name="transaction_id"  value='{{ handon_details.off_transaction_id }}' placeholder='Enter transaction ID'>
                                <div class="invalid-feedback">Transaction ID is required</div>
                            </div>
                        </div>
                        {% endif %}
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Payment Mode <span
                                        class='text-danger'>*</span></label>
                                <select class='form-control select2' data-placeholder='Select payment mode' id="payment_mode" name="payment_mode" required>
                                    {% if handon_details.off_transaction_status == 1 %}
                                    <option>Online</option>
                                    {% endif %}
                                    <option value="1" {% if handon_details.off_transaction_payment_mode == '1' %} selected {% endif %}>Cash</option>
                                    <option value="2" {% if handon_details.off_transaction_payment_mode == '2' %} selected {% endif %}>Cheque/DD</option>
                                    <option value="3" {% if handon_details.off_transaction_payment_mode == '3' %} selected {% endif %}>POS</option>
                                    <option value="4" {% if handon_details.off_transaction_payment_mode == '4' %} selected {% endif %}>Venmo</option>
                                    <option value="5" {% if handon_details.off_transaction_payment_mode == '5' %} selected {% endif %}>Others</option>
                                </select>
                                <div class="invalid-feedback">Payment mode is required</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Payment Details</label>
                                <input type="text" class="form-control" placeholder='Enter payment details' id="payment_details" name="payment_details" value="{{ handon_details.off_transaction_payment_details }}">
                                <div class="invalid-feedback">Payment details is required</div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label class="form-label mt-3 mt-0">Memo </label>
                                <textarea rows="5" class='form-control' id="memo" name="memo" placeholder='Enter memo'>{{ handon_details.off_transaction_memo }}</textarea>
                                <div class="invalid-feedback">Email is required</div>
                                <p class='fw-600 fs-14 mt-3'>Registration Done By: Admin</p>
                            </div>
                        </div>
                        <div class="col-12 text-end">
                            <button type='reset' class="btn btn-light px-md-5 me-2" name="reset_frm" id="reset_frm">Reset All</button>
                            <button class="btn btn-primary px-md-5" type='submit' name="register_frm" id="register_frm">Register</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<!-- end row -->

{% endblock content %}

{% block extra_javascript %}

<!-- Sweet Alerts js -->
<script src="{% static 'libs/sweetalert2/sweetalert2.min.js' %}"></script>


<script src="{% static 'libs/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}"></script>

<!-- Form validation -->
<script src="{% static 'js/pages/form-validation.init.js' %}"></script>

<!-- jquery.inputmask.bundle.js -->
<script src="{% static 'js/plugins/jquery.inputmask.bundle.js' %}"></script>

<script src="{% static 'libs/select2/js/select2.min.js' %}"></script>

<script>
    $(document).ready(function () {
        $('#phone').inputmask("(999) 999-9999");
        $('.select2').select2();
        $(".ada_num").inputmask("999 99 9999",{
            numericInput: true,
            autoUnmask: true,
        });
        $(".id_num").inputmask("999999",{
            numericInput: true,
            autoUnmask: true,
        });

        var grnd_tot = $("#grnd_tot").val();
        var new_tot = $("#new_tot").val();
        var user_pay = new_tot - grnd_tot;
        $("#user_to_pay").val(user_pay);

        $(document).on('click', '.removebutton', function(e) {
            var id = $(this).attr('data-id');
            var opt = $(this).attr('data-opt');
            if(opt==2){

            }else{
                var no = $(this).closest(".cv_container").find('.cnt_input').val();
                var price = $(this).closest(".cv_container").find('.cnt_input').attr('data-price');
                no = no-1;
                var p = no*price;
                p = p>0?p:0
                $(this).closest(".cv_container").find('.cnt_input').val((no>0?no:''));
                $(this).closest(".cv_container").find('.cv_price').val(p);
            }
            $(this).closest('.boxRowAdd').remove();
            var sum = 0;
            var wh = 0;
            $('.wh_price').each(function(){
                wh += +$(this).val();
            });
            console.log(wh)
            $('.cv_price').each(function(){
                sum += +$(this).val();
            });
            console.log(sum)
            $("#gnd_tot").val(parseInt(wh)+parseInt(sum));
        });
        $(document).on('click', '.wh_removebutton', function(e) {
            var id = $(this).attr('data-id');
            var opt = $(this).attr('data-opt');
            if(opt==2){

            }else{
                var no = $(this).closest(".wh_container").find('.wh_cnt_input').val();
                var price = $(this).closest(".wh_container").find('.wh_cnt_input').attr('data-price');
                no = no-1;
                var p = no*price;
                p = p>0?p:0
                $(this).closest(".wh_container").find('.wh_cnt_input').val((no>0?no:''));
                $(this).closest(".wh_container").find('.wh_price').val(p);
            }
            $(this).closest('.boxRowAdd').remove();
            var sum = 0;
            var cv = 0;
            $('.cv_price').each(function(){
                cv += +$(this).val();
            });
            console.log(cv)
            $('.wh_price').each(function(){
                sum += +$(this).val();
            });
            console.log(sum)
            $("#gnd_tot").val(parseInt(cv)+parseInt(sum));
        });
        $(document).on('change',".ada_num",function(){
            var ada_num_fields = $(this);
            ada_num = $(this).val();
            ada_id = $(this).closest(".cv_container").find("#hdn_cv_id").val();
            if(ada_id == '1' && ada_num!=''){
                $.ajax({
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    url: "{% url 'get_ada_membership_info' %}",
                    type: "POST",
                    dataType: "json",
                    data: {
                        ada_number: ada_num
                    },
                    success: function(data) {
                        if(data.data!=0){
                            var result = JSON.parse(data.data);
                            var fields1 = result[0]['fields'];
                            var name = fields1['First_Name']+' '+fields1['Last_Name'];
                            ada_num_fields.closest('div.ada_fields').find("input.ada_name").val(name);
                        }                        
                    }
                });
            }
        });
        $("#last_name").change(function(){
            var fname = $("#first_name").val();
            var lname = $("#last_name").val();
            if(fname !='' && lname!=""){
                $.ajax({
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    url: "{% url 'get_ada_membership_address' %}",
                    type: "POST",
                    dataType: "json",
                    data: {
                        fname: fname,
                        lname: lname
                    },
                    success: function(data) {
                        if(data.data!=0){
                            var result = JSON.parse(data.data);
                            var fields1 = result[0]['fields'];
                            $("#practice_name").val(fields1['PracticeName']);
                            $("#phone").val(fields1['Phone']);
                            $("#address").val(fields1['Address_Line_1']+' '+fields1['Address_Line_2']+' '+fields1['Address_Line_3']);
                            $("#city").val(fields1['City']);
                            $("#state").val(fields1['State']);
                            $("#zipcode").val(fields1['Zip_Code']);
                        }                        
                    }
                });
            }
        });
        $(document).on('change',".email_in",function(){
            var email = $(this).val();
            if (email !='') {
                if(IsEmail(email) == false){
                    $(this).addClass('err');
                    $(this).closest('div').find('.invalid-feedback').html('Invalid Email');
                    $(this).closest('div').find('.invalid-feedback').css('display', 'block');
                }else {
                    $(this).removeClass('err');
                    $(this).closest('div').find('.invalid-feedback').css('display', 'none');
                }                        
            }else{
                $(this).addClass('err');
                $(this).closest('div').find('.invalid-feedback').html('Invalid Email');
                $(this).closest('div').find('.invalid-feedback').css('display', 'block');
            }
        });
        $("#register_frm").click(function(e){
            var err = 0
            var fname = $("#first_name").val();
            var lname = $("#last_name").val();
            var phone = $("#phone").val();
            var email = $("#email").val();
            var addr = $("#address").val();
            var city = $("#city").val();
            var state = $("#state").val();
            var zip = $("#zipcode").val();
            var tr_date = $("#transaction_date").val();
            var payment_mode = $("#payment_mode").val();

            if(fname != '' && lname !='' && phone != '' && email !='' && addr != '' && city !='' && state != '' && zip !='' && tr_date != '' && payment_mode !='' ){
                if(IsEmail(email) == false){
                    $("#email").addClass('err');
                    $("#email").closest('div').find('.invalid-feedback').html('Invalid Email');
                    $("#email").closest('div').find('.invalid-feedback').css('display', 'block');
                    err++
                }else {
                    $("#email").removeClass('err');
                    $("#email").closest('div').find('.invalid-feedback').css('display', 'none');
                }
                $('#convention_reg_frm').find('input').each(function()
                {
                    if($(this)[0].hasAttribute('required')){
                        if( !$(this).val() ) {
                            $(this).addClass('err');
                            $(this).closest('div').find('.invalid-feedback').css('display', 'block');
                            err++
                            if($(this).hasClass('wh_input_required')){
                                accordionOpen($(this))
                            }
                        }else {
                            $(this).removeClass('err');
                            $(this).closest('div').find('.invalid-feedback').css('display', 'none');
                        }
                    }
                });
                if (err == 0) {
                    e.preventDefault();
                    var convensionType = [];
                    $(".cnt_input").each(function(){
                        var convensionSet = {};
                        if($(this).val()>0){
                            var cv_id = $(this).closest(".cv_container").find("#hdn_cv_id").val();
                            var cv_price = $(this).closest(".cv_container").find("#hdn_cv_price").val();
                            var cnt = $(this).val();
                            var grand = $(this).closest(".cv_container").find(".cv_price").val();
                            var input = [];
                            $("#text-box-"+cv_id+" .boxRow").each(function(){
                                var input2 = {};
                                $(this).find('input').each(function(){
                                    var key = $(this).attr("data-key");
                                    input2[key] = $(this).val();                                    
                                })
                                $(this).find('select').each(function(){
                                    var key = $(this).attr("data-key");
                                    input2[key] = $(this).val();                                    
                                })
                                input.push(input2)
                            })
                            var ip_len = 0
                            ip_len = input.length;
                            if(ip_len == 0){
                                $("#text-box-"+cv_id+".boxRow").each(function(){
                                    var input2 = {};
                                    $(this).find('input').each(function(){
                                        var key = $(this).attr("data-key");
                                        input2[key] = $(this).val();                                    
                                    })
                                    $(this).find('select').each(function(){
                                        var key = $(this).attr("data-key");
                                        input2[key] = $(this).val();                                    
                                    })
                                    input.push(input2)
                                })
                            }
                            convensionSet['id'] = cv_id;
                            convensionSet['price'] = cv_price;
                            convensionSet['cnt'] = cnt;
                            convensionSet['gnd_tot'] = grand;
                            convensionSet['input'] = input;
                            convensionType.push(convensionSet)
                        }
                    })
                    //workshop details starts here
                    var workshops = [];
                    $(".wh_cnt_input").each(function(){
                        var workshopSet = {};
                        if($(this).val()>0){
                            var wh_id = $(this).closest(".wh_container").find("#hdn_wh_id").val();
                            var wh_price = $(this).closest(".wh_container").find("#hdn_wh_price").val();
                            var cnt = $(this).val();
                            var grand = $(this).closest(".wh_container").find(".wh_price").val();
                            var input = [];
                            $("#text-box-wh-"+wh_id+" .boxRow").each(function(){
                                var input2 = {};
                                $(this).find('input').each(function(){
                                    var key = $(this).attr("data-key");
                                    input2[key] = $(this).val();                                    
                                })
                                input.push(input2)
                            })
                            var ip_len = 0
                            ip_len = input.length;
                            if(ip_len == 0){
                                $("#text-box-wh-"+wh_id+".boxRow").each(function(){
                                    var input2 = {};
                                    $(this).find('input').each(function(){
                                        var key = $(this).attr("data-key");
                                        input2[key] = $(this).val();                                    
                                    })
                                    input.push(input2)
                                })
                            }
                            workshopSet['id'] = wh_id;
                            workshopSet['price'] = wh_price;
                            workshopSet['qty'] = cnt;
                            workshopSet['grand'] = grand;
                            workshopSet['input'] = input;
                            workshops.push(workshopSet)
                        }
                    })
                    console.log(convensionType)
                    my_form = $("#convention_reg_frm")[0];
                    data = new FormData(my_form);
                    data.append('conventionType', JSON.stringify(convensionType))
                    data.append('workshops', JSON.stringify(workshops))
                    $("#preloader").prop("display", "block");
                    var url = window.location.href;
                    $.ajax({
                        headers: {
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        url: url,
                        type: "POST",
                        data: data,
                        processData: false,
                        contentType: false,
                        success: function(data) {
                            $("#preloader").prop("display", "none");
                            if (data['err'] == 0) {
                                swal.fire({
                                    title: 'Success',
                                    html: data['msg'],
                                    icon: 'success',
                                    confirmButtonColor: '#3085d6',
                                    confirmButtonText: 'Ok'
                                }).then((result) => {
                                    location.href = "{% url 'convention_transaction' %}"
                                });
                            } else {
                                swal.fire({
                                    title: 'Error',
                                    text: data['msg'],
                                    icon: 'error',
                                    confirmButtonColor: '#3085d6',
                                    confirmButtonText: 'Ok'
                                });
                            }
                        },
                        error: function() {}
                    });
                } else {
                    e.preventDefault()
                    return false;
                }
            }
        });
        $(".add_new_cv").click(function(){
            var convention_id = $(this).closest('.cv_container').find('#hdn_cv_id').val();
            var price = $(this).closest('.cv_container').find('#hdn_cv_price').val();
            var cnt = 0;
            if($(this).closest('.cv_container').find('.cnt_input').val())
                cnt = $(this).closest('.cv_container').find('.cnt_input').val();

            $(this).closest('.cv_container').find('.cnt_input').val(parseInt(cnt)+1)
            var arr1 = ['1','2','5'];
            var arr2 = ['3','4','6','7','16'];
            var arr3 = ['8'];
            var arr4 = ['15'];
            if(jQuery.inArray(convention_id, arr1)!='-1'){
                var createInputTextBox = '<div class="row boxRow boxRowAdd ada_fields">'+
                    '<span class="boxClose removebutton" data-id="'+convention_id+'"><i class="mdi mdi-close"></i></span>'+
                    '<div class="col-md-5 mb-lg-0 mb-3">'+
                        '<input type="text" class="form-control form-control-wof input_required ada_num" data-key="ada" placeholder="ADA#" required>'+
                        '<div class="invalid-feedback">ADA is required</div>'+
                    '</div>'+
                    '<div class="col-md-5">'+
                        '<input type="text" class="form-control form-control-wof input_required ada_name" placeholder="Full name" data-key="name" value="" required>'+
                        '<div class="invalid-feedback">Full name is required</div>'+
                    '</div>'+
                    '<div class="col-md-2">'+
                        '<input type="text" class="form-control-wof sec_price" placeholder="Price" id="sec_tot" data-key="ind_price" value="'+price+'" readonly>'+
                    '</div>'+
                '</div>';
                $('#text-box-'+convention_id).append(createInputTextBox);
                $(".ada_num").inputmask("999 99 9999",{
                    numericInput: true,
                    autoUnmask: true,
                });
            }
            if(jQuery.inArray(convention_id, arr2)!='-1'){
                var createInputTextBox = '<div class="row boxRow boxRowAdd">'+
                    '<span class="boxClose removebutton" data-id="'+convention_id+'"><i class="mdi mdi-close"></i></span>'+
                    '<div class="col-md-10 mb-md-0 mb-3">'+
                        '<input type="text" class="form-control form-control-wof input_required ada_name" data-key="name" placeholder="Full name" required>'+
                        '<div class="invalid-feedback">Full name is required</div>'+
                    '</div>'+
                    '<div class="col-md-2">'+
                        '<input type="text" class="form-control-wof sec_price" placeholder="Price" id="sec_tot" data-key="ind_price" value="'+price+'" readonly>'+
                    '</div>'+
                '</div>';
                $('#text-box-'+convention_id).append(createInputTextBox);
            }
            if(jQuery.inArray(convention_id, arr3)!='-1'){
                var createInputTextBox = '<div class="row boxRow boxRowAdd">'+
                    '<span class="boxClose removebutton" data-id="'+convention_id+'"><i class="mdi mdi-close"></i></span>'+
                    '<div class="col-md-5 mb-lg-0 mb-3">'+
                        '<select class="form-control form-control-wof select2 input_required ada_num" data-placeholder="Code" data-key="ada" required>'+
                            '<option></option>'+
                            '<option value="A - Assistant">A - Assistant</option>'+
                            '<option value="L - Lab Technician">L - Lab Technician</option>'+
                            '<option value="O - Office Staff">O - Office Staff</option>'+
                        '</select>'+
                        '<div class="invalid-feedback">Code is required</div>'+
                    '</div>'+
                    '<div class="col-lg-5">'+
                        '<input type="text" class="form-control form-control-wof input_required ada_name" placeholder="Full name"  data-key="name" required>'+
                        '<div class="invalid-feedback">Full name is required</div>'+
                    '</div>'+
                    '<div class="col-md-2">'+
                        '<input type="text" class="form-control-wof sec_price" placeholder="Price" id="sec_tot" data-key="ind_price" value="'+price+'" readonly>'+
                    '</div>'+
                '</div>';
                $('#text-box-'+convention_id).append(createInputTextBox);
            }
            if(jQuery.inArray(convention_id, arr4)!='-1'){
                var createInputTextBox = '<div class="row boxRow boxRowAdd">'+
                    '<span class="boxClose removebutton" data-id="'+convention_id+'"><i class="mdi mdi-close"></i></span>'+
                    '<div class="col-lg-5">'+
                        '<input type="text" class="form-control form-control-wof input_required ada_name" placeholder="Full name"  data-key="name" required>'+
                        '<div class="invalid-feedback">Full name is required</div>'+
                    '</div>'+
                    '<div class="col-lg-5">'+
                        '<input type="text" class="form-control form-control-wof input_required id_num" data-key="ada" placeholder="ID#" required>'+
                        '<div class="invalid-feedback">ID is required</div>'+
                    '</div>'+
                    '<div class="col-md-2">'+
                        '<input type="text" class="form-control-wof sec_price" placeholder="Price" id="sec_tot" data-key="ind_price" value="'+price+'" readonly>'+
                    '</div>'+
                '</div>';
                $('#text-box-'+convention_id).append(createInputTextBox);
                $(".id_num").inputmask("999999",{
                    numericInput: true,
                    autoUnmask: true,
                });
            }
            $(".cv_container").each(function(){
                sum = 0
                $(this).find('.sec_price').each(function(){
                    if($(this).val())
                        sum += parseInt($(this).val())
                })
                $(this).find('.sec_gnd_total').val(sum)
            })
            gnd_tot = 0
            $('.sec_gnd_total').each(function(){
                if($(this).val())
                    gnd_tot += parseInt($(this).val())
            })

            tot_gnd_val = 0
            $('.sec_gnd_total').each(function(){
                if($(this).val())
                    tot_gnd_val += parseInt($(this).val())
            })
            $('.sec_gnd_total_wh').each(function(){
                if($(this).val())
                    tot_gnd_val += parseInt($(this).val())
            })

            $("#new_tot").val(tot_gnd_val)
            var grnd_tot = $("#grnd_tot").val();
            var new_tot = $("#new_tot").val();
            var user_pay = new_tot - grnd_tot;
            $("#user_to_pay").val(user_pay);
            
        })
        $(".add_new_ws").click(function(){
            var workshop_id = $(this).closest('.wh_container').find('#hdn_wh_id').val();
            var price = $(this).closest('.wh_container').find('#hdn_wh_price').val();
            var cnt = 0;
            if($(this).closest('.wh_container').find('.wh_cnt_input').val())
                cnt = $(this).closest('.wh_container').find('.wh_cnt_input').val();

            var createInputTextBox = '<div class="row boxRow boxRowAdd">'+
                    '<span class="boxClose wh_removebutton" data-id="'+workshop_id+'"><i class="mdi mdi-close"></i></span>'+
                    '<div class="col-lg-10">'+
                        '<input type="text" class="form-control form-control-wof wh_input_required wh_name" data-key="wh_name" placeholder="Full name" required>'+
                        '<div class="invalid-feedback">Full name is required</div>'+
                    '</div>'+
                    '<div class="col-md-2">'+
                        '<input type="text" class="form-control-wof sec_price_wh" placeholder="Price" id="sec_tot_wh" value="'+price+'" readonly>'+
                    '</div>'+
                '</div>';
            $('#text-box-wh-'+workshop_id).append(createInputTextBox);

            $(".wh_container").each(function(){
                sum = 0
                $(this).find('.sec_price_wh').each(function(){
                    if($(this).val())
                        sum += parseInt($(this).val())
                })
                $(this).find('.sec_gnd_total_wh').val(sum)
            })
            gnd_tot = 0
            $('.sec_gnd_total_wh').each(function(){
                if($(this).val())
                    gnd_tot += parseInt($(this).val())
            })

            tot_gnd_val = 0
            $('.sec_gnd_total').each(function(){
                if($(this).val())
                    tot_gnd_val += parseInt($(this).val())
            })
            $('.sec_gnd_total_wh').each(function(){
                if($(this).val())
                    tot_gnd_val += parseInt($(this).val())
            })

            $("#new_tot").val(tot_gnd_val)
            var grnd_tot = $("#grnd_tot").val();
            var new_tot = $("#new_tot").val();
            var user_pay = new_tot - grnd_tot;
            $("#user_to_pay").val(user_pay);
        })
        $('.wh_input_required').keyup(function() {
            var id = $(this).closest(".wh_container").find("#hdn_wh_id").val();
            var opt = $(this).attr('data-opt');
            if(opt==2){
            }else{
                $('#text-box-wh-'+id).find('input').prop('required', true);
                $(this).closest(".wh_container").find('.wh_cnt_input').val(1);
            }
            var p = $(this).closest(".wh_container").find('#hdn_wh_price').val();
            $(this).closest(".wh_container").find('.wh_price').val(p*1);
            var sum = 0;
            var cv = 0;
            $('.cv_price').each(function(){
                cv += +$(this).val();
            });
            console.log(cv)
            $('.wh_price').each(function(){
                sum += +$(this).val();
            });
            console.log(sum)
            $("#gnd_tot").val(parseInt(cv)+parseInt(sum));
        });
        $('.input_required').keyup(function() {
            var id = $(this).closest(".cv_container").find("#hdn_cv_id").val();
            var opt = $(this).attr('data-opt');
            if(opt==2){
            }else{
                $('#text-box-'+id).find('input').prop('required', true);
                $('#text-box-'+id).find('select').prop('required', true);
                $(this).closest(".cv_container").find('.cnt_input').val(1);
            }
            var p = $(this).closest(".cv_container").find('#hdn_cv_price').val();
            $(this).closest(".cv_container").find('.cv_price').val(p*1);
            var sum = 0;
            var wh = 0;
            $('.wh_price').each(function(){
                wh += +$(this).val();
            });
            console.log(wh)
            $('.cv_price').each(function(){
                sum += +$(this).val();
            });
            console.log(sum)
            $("#gnd_tot").val(parseInt(wh)+parseInt(sum));
        });
    })
    function accordionOpen(acc){
        acc.closest('.accordion-item').find('button.accordion-button').click();
    }
    function IsEmail(email) {
        var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (!regex.test(email))
            return false;
        else
            return true;
    }

</script>

{% endblock extra_javascript %}